"use strict";(self["webpackChunkfinal_project"]=self["webpackChunkfinal_project"]||[]).push([[160],{6160:function(t,e,n){n.r(e),n.d(e,{default:function(){return B}});var l=n(6768),a=n(4232),o=n(5130);const s={key:0,class:"loading-overlay"},c={class:"col-md-7 mx-auto"},u={class:"top"},i=(0,l.Lk)("li",null,"/",-1),d=(0,l.Lk)("li",null,"購物車",-1),r=(0,l.Lk)("hr",null,null,-1),p=(0,l.Lk)("p",null,"購物清單",-1),k=(0,l.Lk)("hr",null,null,-1),h={class:"sticky-top"},b={class:"table align-middle"},L=(0,l.Lk)("thead",null,[(0,l.Lk)("tr",null,[(0,l.Lk)("th"),(0,l.Lk)("th",null,"品名"),(0,l.Lk)("th",{style:{width:"150px"}},"數量"),(0,l.Lk)("th",null,"單價")])],-1),m=["disabled","onClick"],C=(0,l.Lk)("i",{class:"bi bi-x"},null,-1),g=[C],y={key:0,class:"text-success"},v={class:"input-group input-group-sm"},f=["onClick"],x=["disabled","onChange","onUpdate:modelValue"],_=["onClick"],I={class:"input-group-text"},$={class:"text-end"},q={key:0,class:"text-success"},E=(0,l.Lk)("td",{colspan:"3",class:"text-end"},"總計",-1),X={class:"text-end"},F={key:0},Q=(0,l.Lk)("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),W={class:"text-end text-success"},w={class:"input-group mb-3 input-group-sm"},U={class:"input-group-append"},V={class:"text-center mt-3"},j={class:"btn btn-outline-secondary mx-2",type:"button"},A={class:"btn btn-outline-secondary mx-2",type:"button"};function J(t,e,n,C,J,K){const M=(0,l.g2)("Loading"),S=(0,l.g2)("router-link");return(0,l.uX)(),(0,l.CE)(l.FK,null,[t.isLoading?((0,l.uX)(),(0,l.CE)("div",s,[(0,l.bF)(M,{active:t.isLoading},null,8,["active"])])):(0,l.Q3)("",!0),(0,l.Lk)("div",c,[(0,l.Lk)("div",u,[(0,l.Lk)("ul",null,[(0,l.Lk)("li",null,[(0,l.bF)(S,{to:"/",class:"cart-router"},{default:(0,l.k6)((()=>[(0,l.eW)("首頁")])),_:1})]),i,d])]),r,p,k,(0,l.Lk)("div",h,[(0,l.Lk)("table",b,[L,(0,l.Lk)("tbody",null,[t.cart.carts?((0,l.uX)(!0),(0,l.CE)(l.FK,{key:0},(0,l.pI)(t.cart.carts,(e=>((0,l.uX)(),(0,l.CE)("tr",{key:e.id},[(0,l.Lk)("td",null,[(0,l.Lk)("button",{type:"button",class:"btn btn-outline-danger btn-sm",disabled:t.status.loadingItem===e.id,onClick:t=>K.removeCartItem(e.id)},g,8,m)]),(0,l.Lk)("td",null,[(0,l.eW)((0,a.v_)(e.product.title)+" ",1),e.coupon?((0,l.uX)(),(0,l.CE)("div",y," 已套用優惠券 ")):(0,l.Q3)("",!0)]),(0,l.Lk)("td",null,[(0,l.Lk)("div",v,[(0,l.Lk)("button",{class:"btn btn-outline-secondary",onClick:t=>K.decrement(e)},"-",8,f),(0,l.bo)((0,l.Lk)("input",{type:"number",class:"form-control",min:"1",disabled:e.id===t.status.loadingItem,onChange:t=>K.updateCart(e),"onUpdate:modelValue":t=>e.qty=t},null,40,x),[[o.Jo,e.qty,void 0,{number:!0}]]),(0,l.Lk)("button",{class:"btn btn-outline-secondary",onClick:t=>K.increment(e)},"+",8,_),(0,l.Lk)("div",I,"/ "+(0,a.v_)(e.product.unit),1)])]),(0,l.Lk)("td",$,[t.cart.final_total!==t.cart.total?((0,l.uX)(),(0,l.CE)("small",q,"折扣價：")):(0,l.Q3)("",!0),(0,l.eW)(" "+(0,a.v_)(t.$filters.currency(e.final_total)),1)])])))),128)):(0,l.Q3)("",!0)]),(0,l.Lk)("tfoot",null,[(0,l.Lk)("tr",null,[E,(0,l.Lk)("td",X,(0,a.v_)(t.$filters.currency(t.cart.total)),1)]),t.cart.final_total!==t.cart.total?((0,l.uX)(),(0,l.CE)("tr",F,[Q,(0,l.Lk)("td",W,(0,a.v_)(t.$filters.currency(t.cart.final_total)),1)])):(0,l.Q3)("",!0)])]),(0,l.Lk)("div",w,[(0,l.bo)((0,l.Lk)("input",{type:"text",class:"form-control","onUpdate:modelValue":e[0]||(e[0]=t=>J.coupon_code=t),placeholder:"請輸入優惠碼"},null,512),[[o.Jo,J.coupon_code]]),(0,l.Lk)("div",U,[(0,l.Lk)("button",{class:"btn btn-outline-secondary",type:"button",onClick:e[1]||(e[1]=(...t)=>K.addCouponCode&&K.addCouponCode(...t))}," 套用優惠碼 ")])]),(0,l.Lk)("div",V,[(0,l.Lk)("button",j,[(0,l.bF)(S,{class:"navbar-brand",to:"/user/list"},{default:(0,l.k6)((()=>[(0,l.eW)("繼續購物")])),_:1})]),(0,l.Lk)("button",A,[(0,l.bF)(S,{class:"navbar-brand",to:"/user/checkinfo"},{default:(0,l.k6)((()=>[(0,l.eW)("前往結帳")])),_:1})])])])])],64)}var K=n(2389),M={emits:["cart-updated"],data(){return{coupon_code:""}},methods:{addCouponCode(){const t="https://vue3-course-api.hexschool.io/api/applehung1-api/coupon",e={code:this.coupon_code};this.$http.post(t,{data:e}).then((t=>{this.$httpMessageState(t,"加入優惠券"),console.log(t),this.getCart()}))},updateCart(t){const e=`https://vue3-course-api.hexschool.io/api/applehung1-api/cart/${t.id}`;this.isLoading=!0,this.status.loadingItem=t.id;const n={product_id:t.product_id,qty:t.qty};this.$http.put(e,{data:n}).then((t=>(console.log(t),this.status.loadingItem="",this.getCart()))).then((t=>{this.$emit("cart-updated",this.cart),console.log("觸發updateCart",this.cartItemCount)}))},removeCartItem(t){console.log("移除此項"),this.status.loadingItem=t;const e=`https://vue3-course-api.hexschool.io/api/applehung1-api/cart/${t}`;this.$http.delete(e).then((t=>(this.status.loadingItem="",console.log(t),this.getCart()))).then((t=>{this.$emit("cart-updated",this.cart),console.log("觸發removeCartItem",this.cartItemCount)}))},increment(t){t.qty+=1,this.updateCart(t)},decrement(t){t.qty>1&&(t.qty-=1,this.updateCart(t))}},mixins:[K.A]},S=n(1241);const z=(0,S.A)(M,[["render",J]]);var B=z}}]);
//# sourceMappingURL=160.e2f1e49e.js.map