"use strict";(self["webpackChunkfinal_project"]=self["webpackChunkfinal_project"]||[]).push([[730],{2389:function(t,e){e.A={data(){return{cart:{},isLoading:!1,cartItemCount:0,status:{loadingItem:""}}},methods:{getCart(){return new Promise(((t,e)=>{const s="https://vue3-course-api.hexschool.io/api/applehung1-api/cart";this.isLoading=!0,this.$http.get(s).then((e=>{console.log(e),this.cart=e.data.data,this.cartItemCount=this.cart.carts.reduce(((t,e)=>t+e.qty),0),this.isLoading=!1,t(e)})).catch((t=>{this.isLoading=!1,e(t)}))}))}},created(){this.getCart()}}},8730:function(t,e,s){s.r(e),s.d(e,{default:function(){return H}});var r=s(6768),i=s(5130),a=s(4232);const c={class:"container"},o={class:"container-inside"},l={id:"sidebar",class:"left-sidebar col-md-3"},d=(0,r.Lk)("h4",{class:"widget-title"},"購買花禮Online Shop",-1),n=(0,r.Lk)("hr",null,null,-1),u={class:"search-area"},h={class:"widget_categories"},p=["onClick"],g={class:"col-md-9"},k={class:"content-top clearfix"},L=(0,r.Lk)("h1",{class:"main-title"},"購買花禮Online Shop",-1),C={class:"content-top-right"},v={class:"sort-block"},m=(0,r.Lk)("label",{for:"sortOrder"},"排序方式：",-1),y=(0,r.Lk)("option",{value:"",disabled:""},"請選擇排序方式",-1),b=(0,r.Lk)("option",{value:"priceAsc"},"價格由低到高",-1),f=(0,r.Lk)("option",{value:"priceDesc"},"價格由高到低",-1),w=[y,b,f],I={class:"breadcrumb"},P=(0,r.Lk)("li",null,"/",-1),_=(0,r.Lk)("li",null,"購買花禮Online Shop",-1),E=(0,r.Lk)("hr",null,null,-1),S={class:"product-grid"},X={class:"product-item-list"},$=["onClick"],O={class:"title-cart"},x=["onClick"],Q=["disabled","onClick"],F={key:0,class:"spinner-grow spinner-grow-sm text-danger",role:"status"},A=(0,r.Lk)("span",{class:"visually-hidden"},"Loading...",-1),q=[A],K=(0,r.Lk)("i",{class:"bi bi-cart-fill"},null,-1),j={class:"price"},D={key:0,class:"h5"},U={key:1,class:"h6"},B={key:2,class:"h7"},V=(0,r.Lk)("div",{class:"my-5 row justify-content-center"},null,-1);function z(t,e,s,y,b,f){const A=(0,r.g2)("Loading"),z=(0,r.g2)("router-link");return(0,r.uX)(),(0,r.CE)(r.FK,null,[(0,r.bF)(A,{active:b.isLoading},null,8,["active"]),(0,r.Lk)("div",c,[(0,r.Lk)("div",o,[(0,r.Lk)("aside",l,[d,n,(0,r.Lk)("div",u,[(0,r.bo)((0,r.Lk)("input",{type:"text",class:"form-control",name:"name",placeholder:"(請輸入商品名稱)","onUpdate:modelValue":e[0]||(e[0]=t=>b.searchQuery=t)},null,512),[[i.Jo,b.searchQuery]]),(0,r.Lk)("i",{class:"bi bi-search search-icon",onClick:e[1]||(e[1]=(...t)=>f.performSearch&&f.performSearch(...t))})]),(0,r.Lk)("div",h,[(0,r.Lk)("ul",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(f.uniqueCategories,((t,e)=>((0,r.uX)(),(0,r.CE)("li",{key:e,class:(0,a.C4)({active:t===b.activeCategory})},[(0,r.Lk)("a",{href:"#",onClick:(0,i.D$)((e=>f.filterByCategory(t)),["prevent"])},(0,a.v_)(t),9,p)],2)))),128))])])]),(0,r.Lk)("div",g,[(0,r.Lk)("header",k,[L,(0,r.Lk)("div",C,[(0,r.Lk)("div",v,[m,(0,r.bo)((0,r.Lk)("select",{id:"sortOrder",class:"form-select","onUpdate:modelValue":e[2]||(e[2]=t=>b.selectedSortOrder=t),onChange:e[3]||(e[3]=(...t)=>f.sortProducts&&f.sortProducts(...t))},w,544),[[i.u1,b.selectedSortOrder]])]),(0,r.Lk)("ul",I,[(0,r.Lk)("li",null,[(0,r.bF)(z,{class:"home-router-li",to:"/"},{default:(0,r.k6)((()=>[(0,r.eW)("首頁")])),_:1})]),P,_])])]),E,(0,r.Lk)("div",S,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(f.filteredProducts,(t=>((0,r.uX)(),(0,r.CE)("div",{class:"product-item",key:t.id},[(0,r.Lk)("div",X,[(0,r.Lk)("div",{style:(0,a.Tr)([{height:"180px","background-size":"cover","background-position":"center"},{backgroundImage:`url(${t.imageUrl})`}]),onClick:e=>f.getProduct(t.id)},null,12,$),(0,r.Lk)("div",O,[(0,r.Lk)("p",{onClick:e=>f.getProduct(t.id)},(0,a.v_)(t.title),9,x),(0,r.Lk)("button",{type:"button",class:"btn",disabled:this.status.loadingItem===t.id,onClick:e=>f.addCart(t.id)},[this.status.loadingItem===t.id?((0,r.uX)(),(0,r.CE)("div",F,q)):(0,r.Q3)("",!0),K],8,Q)])]),(0,r.Lk)("div",j,[t.price?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.CE)("div",D,(0,a.v_)(t.origin_price),1)),t.price?((0,r.uX)(),(0,r.CE)("del",U,"$ "+(0,a.v_)(t.origin_price),1)):(0,r.Q3)("",!0),t.price?((0,r.uX)(),(0,r.CE)("div",B,"$ "+(0,a.v_)(t.price),1)):(0,r.Q3)("",!0)])])))),128)),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(3-f.filteredProducts.length%3,(t=>((0,r.uX)(),(0,r.CE)("div",{key:`placeholder-${t}`,class:"product-placeholder"})))),128))])])]),V])],64)}s(4114),s(7642),s(8004),s(3853),s(5876),s(2475),s(5024),s(1698);var J=s(2389),T={emits:["cart-updated"],data(){return{products:[],product:{},searchQuery:"",search:"",selectedCategory:"全部",activeCategory:"全部",isLoading:!1,cart:{},showCart:!1,selectedSortOrder:"",status:{loadingItem:""}}},methods:{getProducts(t=1){const e="https://vue3-course-api.hexschool.io/api/applehung1-api/products/all";this.isLoading=!0,this.$http.get(e).then((t=>{this.products=t.data.products,console.log("products:",t),this.isLoading=!1}))},getProduct(t){this.$router.push(`/user/product/${t}`)},performSearch(){this.search=this.searchQuery},filterByCategory(t){this.selectedCategory=t,this.activeCategory=t},addCart(t){const e="https://vue3-course-api.hexschool.io/api/applehung1-api/cart";this.status.loadingItem=t;const s={product_id:t,qty:1};this.$http.post(e,{data:s}).then((t=>(this.status.loadingItem="",console.log("addcart-res",t),this.getCart()))).then((t=>{this.$emit("cart-updated",this.cart),console.log("觸發addCart",this.cartItemCount)}))},sortProducts(){switch(this.selectedSortOrder){case"priceAsc":this.products.sort(((t,e)=>t.price-e.price));break;case"priceDesc":this.products.sort(((t,e)=>e.price-t.price));break;default:break}}},created(){this.getProducts()},computed:{uniqueCategories(){const t=this.products.map((t=>t.category));return["全部",...new Set(t)]},filteredProducts(){return this.products.filter((t=>{const e="全部"===this.selectedCategory||t.category===this.selectedCategory,s=!this.search||t.title.toLowerCase().includes(this.search.toLowerCase());return e&&s}))}},mixins:[J.A]},W=s(1241);const G=(0,W.A)(T,[["render",z]]);var H=G}}]);
//# sourceMappingURL=730.7b269ab8.js.map