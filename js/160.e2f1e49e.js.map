{"version":3,"file":"js/160.e2f1e49e.js","mappings":"iNAAAA,IAAA,EACwBC,MAAM,mB,GAIvBA,MAAM,oB,GACJA,MAAM,O,GAGPC,EAAAA,EAAAA,IAAU,UAAN,KAAC,G,GACLA,EAAAA,EAAAA,IAAY,UAAR,OAAG,G,GAGXA,EAAAA,EAAAA,IAAI,mB,GACJA,EAAAA,EAAAA,IAAW,SAAR,QAAI,G,GACPA,EAAAA,EAAAA,IAAI,mB,GAECD,MAAM,c,GACFA,MAAM,sB,GACXC,EAAAA,EAAAA,IAOQ,eANNA,EAAAA,EAAAA,IAKK,YAJHA,EAAAA,EAAAA,IAAS,OACTA,EAAAA,EAAAA,IAAW,UAAP,OACJA,EAAAA,EAAAA,IAAgC,MAA5BC,MAAA,iBAAqB,OACzBD,EAAAA,EAAAA,IAAW,UAAP,UAAE,G,EAxBlB,uB,GAkCkBA,EAAAA,EAAAA,IAAuB,KAApBD,MAAM,WAAS,S,GAAlBG,G,GAlClBJ,IAAA,EAuCqBC,MAAM,gB,GAKNA,MAAM,8B,EA5C3B,Y,EAAA,8C,EAAA,Y,GAoDuBA,MAAM,oB,GAGXA,MAAM,Y,GAvDxBD,IAAA,EAwD8DC,MAAM,gB,GAQxDC,EAAAA,EAAAA,IAAwC,MAApCG,QAAQ,IAAIJ,MAAM,YAAW,MAAE,G,GAC/BA,MAAM,Y,GAjEtBD,IAAA,G,GAoEYE,EAAAA,EAAAA,IAAsD,MAAlDG,QAAQ,IAAIJ,MAAM,yBAAwB,OAAG,G,GAC7CA,MAAM,yB,GAIXA,MAAM,mC,GAEJA,MAAM,sB,GAMRA,MAAM,oB,GACDA,MAAM,iCAAiCK,KAAK,U,GAG5CL,MAAM,iCAAiCK,KAAK,U,gGArF5DC,EAAAA,EAAAA,IAAAC,EAAAA,GAAA,MACaC,EAAAC,YAAS,WAApBH,EAAAA,EAAAA,IAEM,MAFNI,EAEM,EADJC,EAAAA,EAAAA,IAAuCC,EAAA,CAA7BC,OAAQL,EAAAC,WAAS,uBAF/BK,EAAAA,EAAAA,IAAA,QAKEb,EAAAA,EAAAA,IAqFM,MArFNc,EAqFM,EApFJd,EAAAA,EAAAA,IAMM,MANNe,EAMM,EALJf,EAAAA,EAAAA,IAIK,YAHHA,EAAAA,EAAAA,IAAiE,YAA7DU,EAAAA,EAAAA,IAAwDM,EAAA,CAA3CC,GAAG,IAAIlB,MAAM,e,CARtCmB,SAAAC,EAAAA,EAAAA,KAQoD,IAAE,EARtDC,EAAAA,EAAAA,IAQoD,SARpDC,EAAA,MASQC,EACAC,MAGJC,EACAC,EACAC,GAEA1B,EAAAA,EAAAA,IAwEM,MAxEN2B,EAwEM,EAvEJ3B,EAAAA,EAAAA,IAsDQ,QAtDR4B,EAsDQ,CArDNC,GAQA7B,EAAAA,EAAAA,IAkCQ,cAjCUO,EAAAuB,KAAKC,QAAK,aACxB1B,EAAAA,EAAAA,IA8BKC,EAAAA,GAAA,CA3DjBR,IAAA,IAAAkC,EAAAA,EAAAA,IA6B+BzB,EAAAuB,KAAKC,OAAbE,K,WAAX5B,EAAAA,EAAAA,IA8BK,MA9B2BP,IAAKmC,EAAKC,I,EACxClC,EAAAA,EAAAA,IAMK,YALHA,EAAAA,EAAAA,IAIS,UAJDI,KAAK,SAASL,MAAM,gCACnBoC,SAAU5B,EAAA6B,OAAOC,cAAgBJ,EAAKC,GACtCI,QAAKC,GAAEC,EAAAC,eAAeR,EAAKC,KAjCpDQ,EAAA,EAAAC,MAqCc3C,EAAAA,EAAAA,IAKK,YA1CnBoB,EAAAA,EAAAA,KAAAwB,EAAAA,EAAAA,IAsCmBX,EAAKY,QAAQC,OAAQ,IACxB,GAAgCb,EAAKc,SAAM,WAA3C1C,EAAAA,EAAAA,IAEM,MAFN2C,EAA6C,cAvC7DnC,EAAAA,EAAAA,IAAA,UA2Ccb,EAAAA,EAAAA,IAWK,YAVHA,EAAAA,EAAAA,IASM,MATNiD,EASM,EARJjD,EAAAA,EAAAA,IAA6E,UAArED,MAAM,4BAA6BuC,QAAKC,GAAEC,EAAAU,UAAUjB,IAAO,IAAC,EA7CtFkB,IAAA,SA8CkBnD,EAAAA,EAAAA,IAIgC,SAJzBI,KAAK,SAASL,MAAM,eACrBqD,IAAI,IACHjB,SAAUF,EAAKC,KAAO3B,EAAA6B,OAAOC,YAC7BgB,SAAMd,GAAEC,EAAAc,WAAWrB,GAjD5C,sBAAAM,GAkDwCN,EAAKsB,IAAGhB,G,QAlDhDiB,GAAA,OAkDwCvB,EAAKsB,SAAG,GAlDhDE,QAkDwB,OACNzD,EAAAA,EAAAA,IAA6E,UAArED,MAAM,4BAA6BuC,QAAKC,GAAEC,EAAAkB,UAAUzB,IAAO,IAAC,EAnDtF0B,IAoDkB3D,EAAAA,EAAAA,IAA6D,MAA7D4D,EAA8B,MAAEhB,EAAAA,EAAAA,IAAGX,EAAKY,QAAQgB,MAAI,QAGxD7D,EAAAA,EAAAA,IAGK,KAHL8D,EAGK,CAFUvD,EAAAuB,KAAKiC,cAAgBxD,EAAAuB,KAAKkC,QAAK,WAA5C3D,EAAAA,EAAAA,IAA+E,QAA/E4D,EAAmE,UAxDnFpD,EAAAA,EAAAA,IAAA,QAAAO,EAAAA,EAAAA,IAwD+F,KAC/EwB,EAAAA,EAAAA,IAAGrC,EAAA2D,SAASC,SAASlC,EAAK8B,cAAW,U,OAzDrDlD,EAAAA,EAAAA,IAAA,UA8DQb,EAAAA,EAAAA,IASQ,eARNA,EAAAA,EAAAA,IAGK,WAFHoE,GACApE,EAAAA,EAAAA,IAA6D,KAA7DqE,GAA6DzB,EAAAA,EAAAA,IAArCrC,EAAA2D,SAASC,SAAS5D,EAAAuB,KAAKkC,QAAK,KAE5CzD,EAAAuB,KAAKiC,cAAgBxD,EAAAuB,KAAKkC,QAAK,WAAzC3D,EAAAA,EAAAA,IAGK,KAtEfiE,EAAA,CAoEYC,GACAvE,EAAAA,EAAAA,IAAgF,KAAhFwE,GAAgF5B,EAAAA,EAAAA,IAA3CrC,EAAA2D,SAASC,SAAS5D,EAAAuB,KAAKiC,cAAW,OArEnFlD,EAAAA,EAAAA,IAAA,YAyEMb,EAAAA,EAAAA,IAOM,MAPNyE,EAOM,WANJzE,EAAAA,EAAAA,IAAmF,SAA5EI,KAAK,OAAOL,MAAM,eA1EjC,sBAAA2E,EAAA,KAAAA,EAAA,GAAAnC,GA0EyDoC,EAAAC,YAAWrC,GAAEsC,YAAY,U,iBAAzBF,EAAAC,gBACjD5E,EAAAA,EAAAA,IAIM,MAJN8E,EAIM,EAHJ9E,EAAAA,EAAAA,IAES,UAFDD,MAAM,4BAA4BK,KAAK,SAAUkC,QAAKoC,EAAA,KAAAA,EAAA,OAAAK,IAAEvC,EAAAwC,eAAAxC,EAAAwC,iBAAAD,KAAe,gBAKnF/E,EAAAA,EAAAA,IAOM,MAPNiF,EAOM,EANJjF,EAAAA,EAAAA,IAES,SAFTkF,EAES,EADPxE,EAAAA,EAAAA,IAAoEM,EAAA,CAAvDjB,MAAM,eAAekB,GAAG,c,CAnF/CC,SAAAC,EAAAA,EAAAA,KAmF4D,IAAI,EAnFhEC,EAAAA,EAAAA,IAmF4D,WAnF5DC,EAAA,OAqFQrB,EAAAA,EAAAA,IAES,SAFTmF,EAES,EADPzE,EAAAA,EAAAA,IAAyEM,EAAA,CAA5DjB,MAAM,eAAekB,GAAG,mB,CAtF/CC,SAAAC,EAAAA,EAAAA,KAsFiE,IAAI,EAtFrEC,EAAAA,EAAAA,IAsFiE,WAtFjEC,EAAA,a,kBAgGA,GACE+D,MAAO,CAAC,gBACRC,IAAAA,GACE,MAAO,CACLT,YAAa,GAEjB,EACAU,QAAS,CACPN,aAAAA,GACE,MAAMO,EAAM,iEACNxC,EAAS,CACbyC,KAAMC,KAAKb,aAEba,KAAKC,MAAMC,KAAKJ,EAAK,CAAEF,KAAMtC,IAC1B6C,MAAMC,IACLJ,KAAKK,kBAAkBD,EAAK,SAC5BE,QAAQC,IAAIH,GACZJ,KAAKQ,SAAS,GAEpB,EACA3C,UAAAA,CAAYrB,GACV,MAAMsD,EAAM,gEAAkEtD,EAAKC,KACnFuD,KAAKjF,WAAY,EACjBiF,KAAKrD,OAAOC,YAAcJ,EAAKC,GAC/B,MAAMJ,EAAO,CACXoE,WAAYjE,EAAKiE,WACjB3C,IAAKtB,EAAKsB,KAEZkC,KAAKC,MAAMS,IAAIZ,EAAK,CAAEF,KAAMvD,IACzB8D,MAAMQ,IACLL,QAAQC,IAAII,GACZX,KAAKrD,OAAOC,YAAc,GACnBoD,KAAKQ,aAEbL,MAAMQ,IACLX,KAAKY,MAAM,eAAgBZ,KAAK3D,MAChCiE,QAAQC,IAAI,eAAgBP,KAAKa,cAAc,GAErD,EACA7D,cAAAA,CAAgBP,GACd6D,QAAQC,IAAI,QACZP,KAAKrD,OAAOC,YAAcH,EAC1B,MAAMqD,EAAM,gEAAkErD,IAC9EuD,KAAKC,MAAMa,OAAOhB,GACfK,MAAMC,IACLJ,KAAKrD,OAAOC,YAAc,GAC1B0D,QAAQC,IAAIH,GACLJ,KAAKQ,aAEbL,MAAMC,IACLJ,KAAKY,MAAM,eAAgBZ,KAAK3D,MAChCiE,QAAQC,IAAI,mBAAoBP,KAAKa,cAAc,GAEzD,EACA5C,SAAAA,CAAWzB,GACTA,EAAKsB,KAAO,EACZkC,KAAKnC,WAAWrB,EAClB,EACAiB,SAAAA,CAAWjB,GACLA,EAAKsB,IAAM,IACbtB,EAAKsB,KAAO,EACZkC,KAAKnC,WAAWrB,GAEpB,GAEFuE,OAAQ,CAACC,EAAAA,I,UC1JX,MAAMC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,KAEpE,O","sources":["webpack://final-project/./src/views/UserCart.vue","webpack://final-project/./src/views/UserCart.vue?698a"],"sourcesContent":["<template>\r\n  <div v-if=\"isLoading\" class=\"loading-overlay\">\r\n    <Loading :active=\"isLoading\"></Loading>\r\n  </div>\r\n  <!-- 購物車列表 -->\r\n  <div class=\"col-md-7 mx-auto\">\r\n    <div class=\"top\">\r\n      <ul>\r\n        <li><router-link to=\"/\" class=\"cart-router\">首頁</router-link></li>\r\n        <li>/</li>\r\n        <li>購物車</li>\r\n      </ul>\r\n    </div>\r\n    <hr>\r\n    <p>購物清單</p>\r\n    <hr>\r\n    <!-- 購物車列表 -->\r\n    <div class=\"sticky-top\">\r\n      <table class=\"table align-middle\">\r\n        <thead>\r\n          <tr>\r\n            <th></th>\r\n            <th>品名</th>\r\n            <th style=\"width: 150px\">數量</th>\r\n            <th>單價</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <template v-if=\"cart.carts\">\r\n            <tr v-for=\"item in cart.carts\" :key=\"item.id\">\r\n              <td>\r\n                <button type=\"button\" class=\"btn btn-outline-danger btn-sm\"\r\n                        :disabled=\"status.loadingItem === item.id\"\r\n                        @click=\"removeCartItem(item.id)\">\r\n                  <i class=\"bi bi-x\"></i>\r\n                </button>\r\n              </td>\r\n              <td>\r\n                {{ item.product.title }}\r\n                <div class=\"text-success\" v-if=\"item.coupon\">\r\n                  已套用優惠券\r\n                </div>\r\n              </td>\r\n              <td>\r\n                <div class=\"input-group input-group-sm\">\r\n                  <button class=\"btn btn-outline-secondary\" @click=\"decrement(item)\">-</button>\r\n                  <input type=\"number\" class=\"form-control\"\r\n                        min=\"1\"\r\n                        :disabled=\"item.id === status.loadingItem\"\r\n                        @change=\"updateCart(item)\"\r\n                        v-model.number=\"item.qty\">\r\n                  <button class=\"btn btn-outline-secondary\" @click=\"increment(item)\">+</button>\r\n                  <div class=\"input-group-text\">/ {{ item.product.unit }}</div>\r\n                </div>\r\n              </td>\r\n              <td class=\"text-end\">\r\n                <small v-if=\"cart.final_total !== cart.total\" class=\"text-success\">折扣價：</small>\r\n                {{ $filters.currency(item.final_total) }}\r\n              </td>\r\n            </tr>\r\n          </template>\r\n        </tbody>\r\n        <tfoot>\r\n          <tr>\r\n            <td colspan=\"3\" class=\"text-end\">總計</td>\r\n            <td class=\"text-end\">{{ $filters.currency(cart.total) }}</td>\r\n          </tr>\r\n          <tr v-if=\"cart.final_total !== cart.total\">\r\n            <td colspan=\"3\" class=\"text-end text-success\">折扣價</td>\r\n            <td class=\"text-end text-success\">{{ $filters.currency(cart.final_total) }}</td>\r\n          </tr>\r\n        </tfoot>\r\n      </table>\r\n      <div class=\"input-group mb-3 input-group-sm\">\r\n        <input type=\"text\" class=\"form-control\" v-model=\"coupon_code\" placeholder=\"請輸入優惠碼\">\r\n        <div class=\"input-group-append\">\r\n          <button class=\"btn btn-outline-secondary\" type=\"button\" @click=\"addCouponCode\">\r\n            套用優惠碼\r\n          </button>\r\n        </div>\r\n      </div>\r\n      <div class=\"text-center mt-3\">\r\n        <button class=\"btn btn-outline-secondary mx-2\" type=\"button\">\r\n          <router-link class=\"navbar-brand\" to=\"/user/list\">繼續購物</router-link>\r\n        </button>\r\n        <button class=\"btn btn-outline-secondary mx-2\" type=\"button\">\r\n          <router-link class=\"navbar-brand\" to=\"/user/checkinfo\">前往結帳</router-link>\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport cartMixin from '@/mixins/cartMixin'\r\n\r\nexport default {\r\n  emits: ['cart-updated'], // 在此處聲明自定義事件\r\n  data () {\r\n    return {\r\n      coupon_code: ''\r\n    }\r\n  },\r\n  methods: {\r\n    addCouponCode () {\r\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/coupon`\r\n      const coupon = {\r\n        code: this.coupon_code\r\n      }\r\n      this.$http.post(url, { data: coupon })\r\n        .then((res) => {\r\n          this.$httpMessageState(res, '加入優惠券')\r\n          console.log(res)\r\n          this.getCart()\r\n        })\r\n    },\r\n    updateCart (item) {\r\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/cart/${item.id}`\r\n      this.isLoading = true\r\n      this.status.loadingItem = item.id\r\n      const cart = {\r\n        product_id: item.product_id,\r\n        qty: item.qty\r\n      }\r\n      this.$http.put(url, { data: cart })\r\n        .then((response) => {\r\n          console.log(response)\r\n          this.status.loadingItem = ''\r\n          return this.getCart() // 確保返回的 Promise 是 this.getCart() 的\r\n        })\r\n        .then((response) => {\r\n          this.$emit('cart-updated', this.cart) // 發射事件通知父組件\r\n          console.log('觸發updateCart', this.cartItemCount)\r\n        })\r\n    },\r\n    removeCartItem (id) {\r\n      console.log('移除此項')\r\n      this.status.loadingItem = id\r\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/cart/${id}`\r\n      this.$http.delete(url)\r\n        .then((res) => {\r\n          this.status.loadingItem = ''\r\n          console.log(res)\r\n          return this.getCart() // 確保返回的 Promise 是 this.getCart() 的\r\n        })\r\n        .then((res) => {\r\n          this.$emit('cart-updated', this.cart) // 發射事件通知父組件\r\n          console.log('觸發removeCartItem', this.cartItemCount)\r\n        })\r\n    },\r\n    increment (item) {\r\n      item.qty += 1\r\n      this.updateCart(item)\r\n    },\r\n    decrement (item) {\r\n      if (item.qty > 1) {\r\n        item.qty -= 1\r\n        this.updateCart(item)\r\n      }\r\n    }\r\n  },\r\n  mixins: [cartMixin]\r\n}\r\n</script>\r\n\r\n<style>\r\n.loading-overlay {\r\n  z-index: 1;\r\n}\r\n.top ul{\r\n  display: flex;\r\n  justify-content: flex-end\r\n}\r\n.top ul li {\r\n  list-style-type: none;\r\n  margin-right: 7px;\r\n}\r\n.cart-router {\r\n  text-decoration: none;\r\n  color: inherit;\r\n}\r\n</style>\r\n","import { render } from \"./UserCart.vue?vue&type=template&id=3f2df3be\"\nimport script from \"./UserCart.vue?vue&type=script&lang=js\"\nexport * from \"./UserCart.vue?vue&type=script&lang=js\"\n\nimport \"./UserCart.vue?vue&type=style&index=0&id=3f2df3be&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["key","class","_createElementVNode","style","_hoisted_13","colspan","type","_createElementBlock","_Fragment","_ctx","isLoading","_hoisted_1","_createVNode","_component_Loading","active","_createCommentVNode","_hoisted_2","_hoisted_3","_component_router_link","to","default","_withCtx","_createTextVNode","_","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","cart","carts","_renderList","item","id","disabled","status","loadingItem","onClick","$event","$options","removeCartItem","_hoisted_14","_hoisted_12","_toDisplayString","product","title","coupon","_hoisted_15","_hoisted_16","decrement","_hoisted_17","min","onChange","updateCart","qty","_hoisted_18","number","increment","_hoisted_19","_hoisted_20","unit","_hoisted_21","final_total","total","_hoisted_22","$filters","currency","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_28","_cache","$data","coupon_code","placeholder","_hoisted_29","args","addCouponCode","_hoisted_30","_hoisted_31","_hoisted_32","emits","data","methods","url","code","this","$http","post","then","res","$httpMessageState","console","log","getCart","product_id","put","response","$emit","cartItemCount","delete","mixins","cartMixin","__exports__","render"],"sourceRoot":""}