{"version":3,"file":"js/160.d342141d.js","mappings":"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","sources":["webpack://final-project/./src/mixins/cartMixin.js","webpack://final-project/./src/views/UserCart.vue","webpack://final-project/./src/views/UserCart.vue?698a"],"sourcesContent":["export default {\r\n  data () {\r\n    return {\r\n      cart: {},\r\n      isLoading: false,\r\n      cartItemCount: 0, // 用於存儲購物車商品數量\r\n      status: {\r\n        loadingItem: ''\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    getCart () {\r\n      return new Promise((resolve, reject) => {\r\n        const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/cart`\r\n        this.isLoading = true\r\n        this.$http.get(url)\r\n          .then((response) => {\r\n            console.log(response)\r\n            this.cart = response.data.data\r\n            this.cartItemCount = this.cart.carts.reduce((total, item) => total + item.qty, 0)\r\n            this.isLoading = false\r\n            resolve(response) // 確保 Promise 被 resolved\r\n          })\r\n          .catch((error) => {\r\n            this.isLoading = false\r\n            reject(error) // 確保 Promise 被 rejected\r\n          })\r\n      })\r\n    }\r\n  },\r\n  created () {\r\n    this.getCart()\r\n  }\r\n}\r\n","<template>\r\n  <div v-if=\"isLoading\" class=\"loading-overlay\">\r\n    <Loading :active=\"isLoading\"></Loading>\r\n  </div>\r\n  <!-- 購物車列表 -->\r\n  <div class=\"col-md-7 mx-auto\">\r\n    <div class=\"top\">\r\n      <ul>\r\n        <li><router-link to=\"/\" class=\"cart-router\">首頁</router-link></li>\r\n        <li>/</li>\r\n        <li>購物車</li>\r\n      </ul>\r\n    </div>\r\n    <hr>\r\n    <p>購物清單</p>\r\n    <hr>\r\n    <!-- 購物車列表 -->\r\n    <div class=\"sticky-top\">\r\n      <table class=\"table align-middle\">\r\n        <thead>\r\n          <tr>\r\n            <th></th>\r\n            <th>品名</th>\r\n            <th style=\"width: 150px\">數量</th>\r\n            <th>單價</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <template v-if=\"cart.carts\">\r\n            <tr v-for=\"item in cart.carts\" :key=\"item.id\">\r\n              <td>\r\n                <button type=\"button\" class=\"btn btn-outline-danger btn-sm\"\r\n                        :disabled=\"status.loadingItem === item.id\"\r\n                        @click=\"removeCartItem(item.id)\">\r\n                  <i class=\"bi bi-x\"></i>\r\n                </button>\r\n              </td>\r\n              <td>\r\n                {{ item.product.title }}\r\n                <div class=\"text-success\" v-if=\"item.coupon\">\r\n                  已套用優惠券\r\n                </div>\r\n              </td>\r\n              <td>\r\n                <div class=\"input-group input-group-sm\">\r\n                  <button class=\"btn btn-outline-secondary\" @click=\"decrement(item)\">-</button>\r\n                  <input type=\"number\" class=\"form-control\"\r\n                        min=\"1\"\r\n                        :disabled=\"item.id === status.loadingItem\"\r\n                        @change=\"updateCart(item)\"\r\n                        v-model.number=\"item.qty\">\r\n                  <button class=\"btn btn-outline-secondary\" @click=\"increment(item)\">+</button>\r\n                  <div class=\"input-group-text\">/ {{ item.product.unit }}</div>\r\n                </div>\r\n              </td>\r\n              <td class=\"text-end\">\r\n                <small v-if=\"cart.final_total !== cart.total\" class=\"text-success\">折扣價：</small>\r\n                {{ $filters.currency(item.final_total) }}\r\n              </td>\r\n            </tr>\r\n          </template>\r\n        </tbody>\r\n        <tfoot>\r\n          <tr>\r\n            <td colspan=\"3\" class=\"text-end\">總計</td>\r\n            <td class=\"text-end\">{{ $filters.currency(cart.total) }}</td>\r\n          </tr>\r\n          <tr v-if=\"cart.final_total !== cart.total\">\r\n            <td colspan=\"3\" class=\"text-end text-success\">折扣價</td>\r\n            <td class=\"text-end text-success\">{{ $filters.currency(cart.final_total) }}</td>\r\n          </tr>\r\n        </tfoot>\r\n      </table>\r\n      <div class=\"input-group mb-3 input-group-sm\">\r\n        <input type=\"text\" class=\"form-control\" v-model=\"coupon_code\" placeholder=\"請輸入優惠碼\">\r\n        <div class=\"input-group-append\">\r\n          <button class=\"btn btn-outline-secondary\" type=\"button\" @click=\"addCouponCode\">\r\n            套用優惠碼\r\n          </button>\r\n        </div>\r\n      </div>\r\n      <div class=\"text-center mt-3\">\r\n        <button class=\"btn btn-outline-secondary mx-2\" type=\"button\">\r\n          <router-link class=\"navbar-brand\" to=\"/user/list\">繼續購物</router-link>\r\n        </button>\r\n        <button class=\"btn btn-outline-secondary mx-2\" type=\"button\">\r\n          <router-link class=\"navbar-brand\" to=\"/user/checkinfo\">前往結帳</router-link>\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport cartMixin from '@/mixins/cartMixin'\r\n\r\nexport default {\r\n  emits: ['cart-updated'], // 在此處聲明自定義事件\r\n  data () {\r\n    return {\r\n      coupon_code: ''\r\n    }\r\n  },\r\n  methods: {\r\n    addCouponCode () {\r\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/coupon`\r\n      const coupon = {\r\n        code: this.coupon_code\r\n      }\r\n      this.$http.post(url, { data: coupon })\r\n        .then((res) => {\r\n          this.$httpMessageState(res, '加入優惠券')\r\n          console.log(res)\r\n          this.getCart()\r\n        })\r\n    },\r\n    updateCart (item) {\r\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/cart/${item.id}`\r\n      this.isLoading = true\r\n      this.status.loadingItem = item.id\r\n      const cart = {\r\n        product_id: item.product_id,\r\n        qty: item.qty\r\n      }\r\n      this.$http.put(url, { data: cart })\r\n        .then((response) => {\r\n          console.log(response)\r\n          this.status.loadingItem = ''\r\n          return this.getCart() // 確保返回的 Promise 是 this.getCart() 的\r\n        })\r\n        .then((response) => {\r\n          this.$emit('cart-updated', this.cart) // 發射事件通知父組件\r\n          console.log('觸發updateCart', this.cartItemCount)\r\n        })\r\n    },\r\n    removeCartItem (id) {\r\n      console.log('移除此項')\r\n      this.status.loadingItem = id\r\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/cart/${id}`\r\n      this.$http.delete(url)\r\n        .then((res) => {\r\n          this.status.loadingItem = ''\r\n          console.log(res)\r\n          return this.getCart() // 確保返回的 Promise 是 this.getCart() 的\r\n        })\r\n        .then((res) => {\r\n          this.$emit('cart-updated', this.cart) // 發射事件通知父組件\r\n          console.log('觸發removeCartItem', this.cartItemCount)\r\n        })\r\n    },\r\n    increment (item) {\r\n      item.qty += 1\r\n      this.updateCart(item)\r\n    },\r\n    decrement (item) {\r\n      if (item.qty > 1) {\r\n        item.qty -= 1\r\n        this.updateCart(item)\r\n      }\r\n    }\r\n  },\r\n  mixins: [cartMixin]\r\n}\r\n</script>\r\n\r\n<style>\r\n.loading-overlay {\r\n  z-index: 1;\r\n}\r\n.top ul{\r\n  display: flex;\r\n  justify-content: flex-end\r\n}\r\n.top ul li {\r\n  list-style-type: none;\r\n  margin-right: 7px;\r\n}\r\n.cart-router {\r\n  text-decoration: none;\r\n  color: inherit;\r\n}\r\n</style>\r\n","import { render } from \"./UserCart.vue?vue&type=template&id=3f2df3be\"\nimport script from \"./UserCart.vue?vue&type=script&lang=js\"\nexport * from \"./UserCart.vue?vue&type=script&lang=js\"\n\nimport \"./UserCart.vue?vue&type=style&index=0&id=3f2df3be&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["data","cart","isLoading","cartItemCount","status","loadingItem","methods","getCart","Promise","resolve","reject","url","this","$http","get","then","response","console","log","carts","reduce","total","item","qty","catch","error","created","key","class","_createElementVNode","style","_hoisted_13","colspan","type","_createElementBlock","_Fragment","_ctx","_hoisted_1","_createVNode","_component_Loading","active","_createCommentVNode","_hoisted_2","_hoisted_3","_component_router_link","to","default","_withCtx","_createTextVNode","_","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_renderList","id","disabled","onClick","$event","$options","removeCartItem","_hoisted_14","_hoisted_12","_toDisplayString","product","title","coupon","_hoisted_15","_hoisted_16","decrement","_hoisted_17","min","onChange","updateCart","_hoisted_18","number","increment","_hoisted_19","_hoisted_20","unit","_hoisted_21","final_total","_hoisted_22","$filters","currency","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_28","_cache","$data","coupon_code","placeholder","_hoisted_29","args","addCouponCode","_hoisted_30","_hoisted_31","_hoisted_32","emits","code","post","res","$httpMessageState","product_id","put","$emit","delete","mixins","cartMixin","__exports__","render"],"sourceRoot":""}