"use strict";(self["webpackChunkfinal_project"]=self["webpackChunkfinal_project"]||[]).push([[947],{947:function(t,o,e){e.r(o),e.d(o,{default:function(){return P}});var a=e(6768),l=e(4232);const n={class:"text-end"},s={class:"table mt-4"},d=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th",{width:"120"},"標題"),(0,a.Lk)("th",null,"優惠碼"),(0,a.Lk)("th",{width:"120"},"到期日"),(0,a.Lk)("th",{width:"120"},"折扣百分比"),(0,a.Lk)("th",{width:"100"},"是否啟用"),(0,a.Lk)("th",{width:"200"},"更新優惠券")])],-1),p={class:"text-right"},u={class:"text-right"},i={key:0,class:"text-success"},c={key:1,class:"text-muted"},r={class:"btn-group"},m=["onClick"],h=["onClick"];function b(t,o,e,b,k,L){const C=(0,a.g2)("Loading"),f=(0,a.g2)("CouponModal"),g=(0,a.g2)("DelModal");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(C,{active:k.isLoading},null,8,["active"]),(0,a.Lk)("div",n,[(0,a.Lk)("div",{class:"btn btn-primary",type:"button",onClick:o[0]||(o[0]=t=>L.openCouponModal(!0))}," 增加優惠券 ")]),(0,a.Lk)("table",s,[d,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(k.coupons,(o=>((0,a.uX)(),(0,a.CE)("tr",{key:o.id},[(0,a.Lk)("td",null,(0,l.v_)(o.title),1),(0,a.Lk)("td",p,(0,l.v_)(o.code),1),(0,a.Lk)("td",u,(0,l.v_)(t.$filters.date(o.due_date)),1),(0,a.Lk)("td",null,(0,l.v_)(o.percent)+"% ",1),(0,a.Lk)("td",null,[o.is_enabled?((0,a.uX)(),(0,a.CE)("span",i,"啟用")):((0,a.uX)(),(0,a.CE)("span",c,"未啟用"))]),(0,a.Lk)("td",null,[(0,a.Lk)("div",r,[(0,a.Lk)("button",{class:"btn btn-outline-primary btn-sm",onClick:t=>L.openCouponModal(!1,o)},"編輯",8,m),(0,a.Lk)("button",{class:"btn btn-outline-danger btn-sm",onClick:t=>L.openDelCouponModal(o)},"刪除",8,h)])])])))),128))])]),(0,a.bF)(f,{ref:"couponModal",coupon:k.tempCoupon,onUpdateCoupon:L.updateCoupon},null,8,["coupon","onUpdateCoupon"]),(0,a.bF)(g,{ref:"delModal",item:k.tempCoupon,onDelItem:L.delCoupon},null,8,["item","onDelItem"])],64)}var k=e(5130);const L={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},C={class:"modal-dialog modal-xl",role:"document"},f={class:"modal-content border-0"},g=(0,a.Lk)("div",{class:"modal-header bg-dark text-white"},[(0,a.Lk)("h5",{class:"modal-title",id:"exampleModalLabel"},[(0,a.Lk)("span",null,"新增優惠券")]),(0,a.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),v={class:"modal-body"},M={class:"row"},w={class:"col-sm-8"},x={class:"mb-3"},y=(0,a.Lk)("label",{for:"title",class:"form-label"},"標題",-1),D={class:"row gx-2"},_={class:"mb-3 col-md-6"},$=(0,a.Lk)("label",{for:"code",class:"form-label"},"優惠碼",-1),U={class:"mb-3 col-md-6"},E=(0,a.Lk)("label",{for:"due_date",class:"form-label"},"到期日",-1),F={class:"row gx-2"},S={class:"mb-3 col-md-6"},X=(0,a.Lk)("label",{for:"percent",class:"form-label"},"折扣百分比",-1),V=(0,a.Lk)("hr",null,null,-1),A={class:"mb-3"},I={class:"form-check"},J=(0,a.Lk)("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1),j={class:"modal-footer"},N=(0,a.Lk)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function K(t,o,e,l,n,s){return(0,a.uX)(),(0,a.CE)("div",L,[(0,a.Lk)("div",C,[(0,a.Lk)("div",f,[g,(0,a.Lk)("div",v,[(0,a.Lk)("div",M,[(0,a.Lk)("div",w,[(0,a.Lk)("div",x,[y,(0,a.bo)((0,a.Lk)("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":o[0]||(o[0]=t=>n.tempCoupon.title=t),placeholder:"請輸入標題"},null,512),[[k.Jo,n.tempCoupon.title]])]),(0,a.Lk)("div",D,[(0,a.Lk)("div",_,[$,(0,a.bo)((0,a.Lk)("input",{type:"text",class:"form-control",id:"code","onUpdate:modelValue":o[1]||(o[1]=t=>n.tempCoupon.code=t),placeholder:"請輸入優惠碼"},null,512),[[k.Jo,n.tempCoupon.code]])]),(0,a.Lk)("div",U,[E,(0,a.bo)((0,a.Lk)("input",{type:"date",class:"form-control",id:"due_date","onUpdate:modelValue":o[2]||(o[2]=t=>s.formattedDate=t),onInput:o[3]||(o[3]=(...t)=>s.updateDueDate&&s.updateDueDate(...t)),placeholder:"請輸入到期日"},null,544),[[k.Jo,s.formattedDate]])])]),(0,a.Lk)("div",F,[(0,a.Lk)("div",S,[X,(0,a.bo)((0,a.Lk)("input",{type:"number",class:"form-control",id:"percent","onUpdate:modelValue":o[4]||(o[4]=t=>n.tempCoupon.percent=t),placeholder:"請輸入折扣百分比"},null,512),[[k.Jo,n.tempCoupon.percent,void 0,{number:!0}]])])]),V,(0,a.Lk)("div",A,[(0,a.Lk)("div",I,[(0,a.bo)((0,a.Lk)("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":o[5]||(o[5]=t=>n.tempCoupon.is_enabled=t),"true-value":1,"false-value":0,id:"is_enabled"},null,512),[[k.lH,n.tempCoupon.is_enabled]]),J])])])])]),(0,a.Lk)("div",j,[N,(0,a.Lk)("button",{type:"button",class:"btn btn-primary",onClick:o[6]||(o[6]=o=>t.$emit("update-coupon",n.tempCoupon))}," 確認 ")])])])],512)}var H=e(3286),O={props:{coupon:{type:Object,default(){return{}}}},watch:{coupon:{immediate:!0,handler(t){this.tempCoupon={...t},this.tempCoupon.due_date||(this.tempCoupon.due_date=Math.floor(Date.now()/1e3))}}},data(){return{modal:{},tempCoupon:{due_date:Math.floor(Date.now()/1e3)}}},computed:{formattedDate(){const t=new Date(1e3*this.tempCoupon.due_date),o=t.getFullYear(),e=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0");return`${o}-${e}-${a}`}},methods:{updateDueDate(t){const o=new Date(t.target.value);this.tempCoupon.due_date=Math.floor(o.getTime()/1e3)}},mixins:[H.A]},T=e(1241);const Y=(0,T.A)(O,[["render",K]]);var q=Y,z=e(134),B={data(){return{coupons:[],tempCoupon:{},isLoading:!1,isNew:!1}},components:{CouponModal:q,DelModal:z.A},methods:{getCoupons(){const t="https://vue3-course-api.hexschool.io/api/applehung1-api/admin/coupons";this.isLoading=!0,this.$http.get(t).then((t=>{this.isLoading=!1,t.data.success&&(console.log(t.data),this.coupons=t.data.coupons,this.pagination=t.data.pagination)}))},openCouponModal(t,o){t?(this.tempCoupon={},this.tempCoupon.is_enabled=0):this.tempCoupon={...o},this.isNew=t;const e=this.$refs.couponModal;e.showModal()},updateCoupon(t){this.tempCoupon=t;let o="https://vue3-course-api.hexschool.io/api/applehung1-api/admin/coupon",e="post";this.isNew||(o=`https://vue3-course-api.hexschool.io/api/applehung1-api/admin/coupon/${t.id}`,e="put");const a=this.$refs.couponModal;this.$http[e](o,{data:this.tempCoupon}).then((t=>{console.log(t),a.hideModal(),this.getCoupons(),this.$httpMessageState(t,"更新")}))},openDelCouponModal(t){this.tempCoupon={...t};const o=this.$refs.delModal;o.showModal()},delCoupon(){console.log("delete item");const t=`https://vue3-course-api.hexschool.io/api/applehung1-api/admin/coupon/${this.tempCoupon.id}`;this.$http.delete(t).then((t=>{console.log(t.data),this.getCoupons(),this.$httpMessageState(t,"刪除")}))}},created(){this.getCoupons()}};const G=(0,T.A)(B,[["render",b]]);var P=G}}]);
//# sourceMappingURL=947.187d452b.js.map