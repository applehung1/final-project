"use strict";(self["webpackChunkfinal_project"]=self["webpackChunkfinal_project"]||[]).push([[715],{2389:function(t,e){e.A={data(){return{cart:{},isLoading:!1,cartItemCount:0,status:{loadingItem:""}}},methods:{getCart(){return new Promise(((t,e)=>{const i="https://vue3-course-api.hexschool.io/api/applehung1-api/cart";this.isLoading=!0,this.$http.get(i).then((e=>{console.log(e),this.cart=e.data.data,this.cartItemCount=this.cart.carts.reduce(((t,e)=>t+e.qty),0),this.isLoading=!1,t(e)})).catch((t=>{this.isLoading=!1,e(t)}))}))}},created(){this.getCart()}}},5715:function(t,e,i){i.r(e),i.d(e,{default:function(){return O}});var a=i(6768),s=i(4232),o=i(5130);const r={class:"container"},c={class:"row"},n={class:"col-8 container-top"},l={"aria-label":"breadcrumb"},d={class:"breadcrumb"},u={class:"breadcrumb-item"},p={class:"breadcrumb-item active","aria-current":"page"},h={class:"row justify-content-center"},g={class:"col-5"},k={class:"text-center product-image-container"},m=["src"],L={class:"col-3 product-description-container"},v=(0,a.Lk)("br",null,null,-1),y=(0,a.Lk)("hr",{style:{width:"100%"}},null,-1),b={key:0,class:"h5"},f={key:1,class:"h6"},C={key:2,class:"h5"},q=(0,a.Lk)("hr",{style:{width:"100%"}},null,-1),w=(0,a.Lk)("label",{for:"price",class:"form-label"},"購買數量",-1),I={class:"quantity-wrapper"},_=(0,a.Lk)("hr",{style:{width:"100%"}},null,-1),x={key:0,class:"spinner-grow spinner-grow-sm text-danger",role:"status"},$=(0,a.Lk)("span",{class:"visually-hidden"},"Loading...",-1),Q=[$],E=(0,a.Lk)("i",{class:"bi bi-suit-heart-fill"},null,-1),F={class:"center-content col-8 mx-auto"},S=(0,a.Lk)("p",null,"商品特色",-1),X=(0,a.Lk)("hr",null,null,-1),N={style:{"white-space":"pre-wrap","text-align":"left"}};function j(t,e,i,$,j,A){const J=(0,a.g2)("Loading"),P=(0,a.g2)("router-link");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(J,{active:j.isLoading},null,8,["active"]),(0,a.Lk)("div",r,[(0,a.Lk)("div",c,[(0,a.Lk)("div",n,[(0,a.Lk)("nav",l,[(0,a.Lk)("ol",d,[(0,a.Lk)("li",u,[(0,a.bF)(P,{to:"/user/cart",style:{"text-decoration":"none",color:"inherit","font-weight":"normal"}},{default:(0,a.k6)((()=>[(0,a.eW)("購物車")])),_:1})]),(0,a.Lk)("li",p,(0,s.v_)(j.product.title),1)])])])]),(0,a.Lk)("div",h,[(0,a.Lk)("article",g,[(0,a.Lk)("div",k,[(0,a.Lk)("img",{src:j.product.imageUrl,alt:"",class:"img-fluid mb-3 product-image"},null,8,m)])]),(0,a.Lk)("div",L,[(0,a.Lk)("h3",null,(0,s.v_)(j.product.title),1),v,(0,a.Lk)("div",null,(0,s.v_)(j.product.description),1),y,j.product.price?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",b,(0,s.v_)(j.product.origin_price)+" 元",1)),j.product.price?((0,a.uX)(),(0,a.CE)("del",f,"$ "+(0,s.v_)(j.product.origin_price),1)):(0,a.Q3)("",!0),j.product.price?((0,a.uX)(),(0,a.CE)("div",C,"$ "+(0,s.v_)(j.product.price),1)):(0,a.Q3)("",!0),q,w,(0,a.Lk)("div",I,[(0,a.Lk)("button",{class:"btn btn-outline-secondary",onClick:e[0]||(e[0]=(...t)=>A.decrement&&A.decrement(...t))},"-"),(0,a.bo)((0,a.Lk)("input",{type:"text",class:"form-control",id:"unit","onUpdate:modelValue":e[1]||(e[1]=t=>j.product.qty=t),placeholder:"請輸入數量",onInput:e[2]||(e[2]=(...t)=>A.validateQuantity&&A.validateQuantity(...t))},null,544),[[o.Jo,j.product.qty,void 0,{number:!0}]]),(0,a.Lk)("button",{class:"btn btn-outline-secondary",onClick:e[3]||(e[3]=(...t)=>A.increment&&A.increment(...t))},"+")]),_,(0,a.Lk)("button",{type:"button",class:"btn btn-outline-danger",onClick:e[4]||(e[4]=t=>A.addToCart(j.product.id,j.product.qty))},[j.status.loadingItem===j.product.id?((0,a.uX)(),(0,a.CE)("div",x,Q)):(0,a.Q3)("",!0),(0,a.eW)(" 加入購物車 ")]),(0,a.Lk)("button",{type:"button",class:"btn btn-outline-danger",onClick:e[5]||(e[5]=t=>A.addFavorite(j.product.id))},[E,(0,a.eW)(" 加入收藏 ")])])]),(0,a.Lk)("div",F,[S,X,(0,a.Lk)("div",N,(0,s.v_)(j.product.content),1)])])],64)}i(4114);var A=i(2389),J={data(){return{product:{qty:1},id:"",isLoading:!1,status:{loadingItem:""},favorite:""}},methods:{getProduct(){const t=`https://vue3-course-api.hexschool.io/api/applehung1-api/product/${this.id}`;this.isLoading=!0,this.$http.get(t).then((t=>{console.log(t.data),this.isLoading=!1,t.data.success&&(this.product=t.data.product,(!this.product.qty||this.product.qty<1)&&(this.product.qty=1))}))},addToCart(t,e){const i="https://vue3-course-api.hexschool.io/api/applehung1-api/cart";this.status.loadingItem=t;const a={product_id:t,qty:e};this.isLoading=!0,this.$http.post(i,{data:a}).then((t=>(this.isLoading=!1,this.status.loadingItem="",this.$httpMessageState(t,"加入購物車"),this.getCart()))).then((t=>{this.$emit("cart-updated",this.cart),console.log("觸發updateCart",this.cartItemCount)}))},addFavorite(t){const e=JSON.parse(localStorage.getItem("favoriteItems"))||[];e.includes(t)||(e.push(t),localStorage.setItem("favoriteItems",JSON.stringify(e))),console.log("favorite emit:",t)},increment(){this.product.qty+=1},decrement(){this.product.qty>1&&(this.product.qty-=1)},validateQuantity(){(isNaN(this.product.qty)||this.product.qty<1)&&(this.product.qty=1)}},created(){this.id=this.$route.params.productId,this.getProduct()},mixins:[A.A]},P=i(1241);const W=(0,P.A)(J,[["render",j]]);var O=W}}]);
//# sourceMappingURL=715.5bce1896.js.map