{"version":3,"file":"js/991.c3204d55.js","mappings":"uHAAA,KACEA,IAAAA,GACE,MAAO,CACLC,KAAM,CAAC,EACPC,WAAW,EACXC,cAAe,EACfC,OAAQ,CACNC,YAAa,IAGnB,EACAC,QAAS,CACPC,OAAAA,GACE,OAAO,IAAIC,SAAQ,CAACC,EAASC,KAC3B,MAAMC,EAAM,+DACZC,KAAKV,WAAY,EACjBU,KAAKC,MAAMC,IAAIH,GACZI,MAAMC,IACLC,QAAQC,IAAIF,GACZJ,KAAKX,KAAOe,EAAShB,KAAKA,KAC1BY,KAAKT,cAAgBS,KAAKX,KAAKkB,MAAMC,QAAO,CAACC,EAAOC,IAASD,EAAQC,EAAKC,KAAK,GAC/EX,KAAKV,WAAY,EACjBO,EAAQO,EAAS,IAElBQ,OAAOC,IACNb,KAAKV,WAAY,EACjBQ,EAAOe,EAAM,GACb,GAER,GAEFC,OAAAA,GACEd,KAAKL,SACP,E,+GC9BKoB,MAAM,oB,GACJA,MAAM,O,GAGPC,EAAAA,EAAAA,IAAU,UAAN,KAAC,G,GACLA,EAAAA,EAAAA,IAAY,UAAR,OAAG,G,GAGXA,EAAAA,EAAAA,IAAI,mB,GACJA,EAAAA,EAAAA,IAAW,SAAR,QAAI,G,GACPA,EAAAA,EAAAA,IAAI,mB,GAECD,MAAM,c,GACFA,MAAM,sB,GACXC,EAAAA,EAAAA,IAOQ,eANNA,EAAAA,EAAAA,IAKK,YAJHA,EAAAA,EAAAA,IAAS,OACTA,EAAAA,EAAAA,IAAW,UAAP,OACJA,EAAAA,EAAAA,IAAgC,MAA5BC,MAAA,iBAAqB,OACzBD,EAAAA,EAAAA,IAAW,UAAP,UAAE,G,EAtBlB,uB,GAgCkBA,EAAAA,EAAAA,IAAuB,KAApBD,MAAM,WAAS,S,GAAlBG,G,GAhClBC,IAAA,EAqCqBJ,MAAM,gB,GAKNA,MAAM,8B,EA1C3B,8C,GAgDuBA,MAAM,oB,GAGXA,MAAM,Y,GAnDxBI,IAAA,EAoD8DJ,MAAM,gB,GAQxDC,EAAAA,EAAAA,IAAwC,MAApCI,QAAQ,IAAIL,MAAM,YAAW,MAAE,G,GAC/BA,MAAM,Y,GA7DtBI,IAAA,G,GAgEYH,EAAAA,EAAAA,IAAsD,MAAlDI,QAAQ,IAAIL,MAAM,yBAAwB,OAAG,G,GAC7CA,MAAM,yB,GAIXA,MAAM,mC,GAEJA,MAAM,sB,GAOVA,MAAM,oB,GACDA,MAAM,iCAAiCM,KAAK,U,GAG5CN,MAAM,iCAAiCM,KAAK,U,gGAlF1DC,EAAAA,EAAAA,IAAAC,EAAAA,GAAA,OACEC,EAAAA,EAAAA,IAAuCC,EAAA,CAA7BC,OAAQC,EAAArC,WAAS,oBAE3B0B,EAAAA,EAAAA,IAmFM,MAnFNY,EAmFM,EAlFJZ,EAAAA,EAAAA,IAMM,MANNa,EAMM,EALJb,EAAAA,EAAAA,IAIK,YAHHA,EAAAA,EAAAA,IAAiE,YAA7DQ,EAAAA,EAAAA,IAAwDM,EAAA,CAA3CC,GAAG,IAAIhB,MAAM,e,CANtCiB,SAAAC,EAAAA,EAAAA,KAMoD,IAAE,EANtDC,EAAAA,EAAAA,IAMoD,SANpDC,EAAA,MAOQC,EACAC,MAGJC,EACAC,EACAC,GAEAxB,EAAAA,EAAAA,IA8DM,MA9DNyB,EA8DM,EA7DJzB,EAAAA,EAAAA,IAoDQ,QApDR0B,EAoDQ,CAnDNC,GAQA3B,EAAAA,EAAAA,IAgCQ,cA/BUW,EAAAtC,KAAKkB,QAAK,aACxBe,EAAAA,EAAAA,IA4BKC,EAAAA,GAAA,CAvDjBJ,IAAA,IAAAyB,EAAAA,EAAAA,IA2B+BjB,EAAAtC,KAAKkB,OAAbG,K,WAAXY,EAAAA,EAAAA,IA4BK,MA5B2BH,IAAKT,EAAKmC,I,EACxC7B,EAAAA,EAAAA,IAMK,YALHA,EAAAA,EAAAA,IAIS,UAJDK,KAAK,SAASN,MAAM,gCACnB+B,SAAUnB,EAAAnC,OAAOC,cAAgBiB,EAAKmC,GACtCE,QAAKC,GAAEC,EAAAC,eAAexC,EAAKmC,KA/BpDM,EAAA,EAAAC,MAmCcpC,EAAAA,EAAAA,IAKK,YAxCnBkB,EAAAA,EAAAA,KAAAmB,EAAAA,EAAAA,IAoCmB3C,EAAK4C,QAAQC,OAAQ,IACxB,GAAgC7C,EAAK8C,SAAM,WAA3ClC,EAAAA,EAAAA,IAEM,MAFNmC,EAA6C,cArC7DC,EAAAA,EAAAA,IAAA,UAyCc1C,EAAAA,EAAAA,IASK,YARHA,EAAAA,EAAAA,IAOM,MAPN2C,EAOM,WANJ3C,EAAAA,EAAAA,IAIgC,SAJzBK,KAAK,SAASN,MAAM,eACrB6C,IAAI,IACHd,SAAUpC,EAAKmC,KAAOlB,EAAAnC,OAAOC,YAC7BoE,SAAMb,GAAEC,EAAAa,WAAWpD,GA9C5C,sBAAAsC,GA+CwCtC,EAAKC,IAAGqC,G,QA/ChDe,GAAA,OA+CwCrD,EAAKC,SAAG,GA/ChDqD,QA+CwB,OACNhD,EAAAA,EAAAA,IAA6D,MAA7DiD,EAA8B,MAAEZ,EAAAA,EAAAA,IAAG3C,EAAK4C,QAAQY,MAAI,QAGxDlD,EAAAA,EAAAA,IAGK,KAHLmD,EAGK,CAFUxC,EAAAtC,KAAK+E,cAAgBzC,EAAAtC,KAAKoB,QAAK,WAA5Ca,EAAAA,EAAAA,IAA+E,QAA/E+C,EAAmE,UApDnFX,EAAAA,EAAAA,IAAA,QAAAxB,EAAAA,EAAAA,IAoD+F,KAC/EmB,EAAAA,EAAAA,IAAG1B,EAAA2C,SAASC,SAAS7D,EAAK0D,cAAW,U,OArDrDV,EAAAA,EAAAA,IAAA,UA0DQ1C,EAAAA,EAAAA,IASQ,eARNA,EAAAA,EAAAA,IAGK,WAFHwD,GACAxD,EAAAA,EAAAA,IAA6D,KAA7DyD,GAA6DpB,EAAAA,EAAAA,IAArC1B,EAAA2C,SAASC,SAAS5C,EAAAtC,KAAKoB,QAAK,KAE5CkB,EAAAtC,KAAK+E,cAAgBzC,EAAAtC,KAAKoB,QAAK,WAAzCa,EAAAA,EAAAA,IAGK,KAlEfoD,EAAA,CAgEYC,GACA3D,EAAAA,EAAAA,IAAgF,KAAhF4D,GAAgFvB,EAAAA,EAAAA,IAA3C1B,EAAA2C,SAASC,SAAS5C,EAAAtC,KAAK+E,cAAW,OAjEnFV,EAAAA,EAAAA,IAAA,YAqEM1C,EAAAA,EAAAA,IAOM,MAPN6D,EAOM,WANJ7D,EAAAA,EAAAA,IAAmF,SAA5EK,KAAK,OAAON,MAAM,eAtEjC,sBAAA+D,EAAA,KAAAA,EAAA,GAAA9B,GAsEyD+B,EAAAC,YAAWhC,GAAEiC,YAAY,U,iBAAzBF,EAAAC,gBACjDhE,EAAAA,EAAAA,IAIM,MAJNkE,EAIM,EAHJlE,EAAAA,EAAAA,IAES,UAFDD,MAAM,4BAA4BM,KAAK,SAAU0B,QAAK+B,EAAA,KAAAA,EAAA,OAAAK,IAAElC,EAAAmC,eAAAnC,EAAAmC,iBAAAD,KAAe,kBAMrFnE,EAAAA,EAAAA,IAOM,MAPNqE,EAOM,EANJrE,EAAAA,EAAAA,IAES,SAFTsE,EAES,EADP9D,EAAAA,EAAAA,IAAoEM,EAAA,CAAvDf,MAAM,eAAegB,GAAG,c,CAhF7CC,SAAAC,EAAAA,EAAAA,KAgF0D,IAAI,EAhF9DC,EAAAA,EAAAA,IAgF0D,WAhF1DC,EAAA,OAkFMnB,EAAAA,EAAAA,IAES,SAFTuE,EAES,EADP/D,EAAAA,EAAAA,IAAyEM,EAAA,CAA5Df,MAAM,eAAegB,GAAG,mB,CAnF7CC,SAAAC,EAAAA,EAAAA,KAmF+D,IAAI,EAnFnEC,EAAAA,EAAAA,IAmF+D,WAnF/DC,EAAA,W,kBA4FA,GACEqD,MAAO,CAAC,gBACRpG,IAAAA,GACE,MAAO,CACL4F,YAAa,GAEjB,EACAtF,QAAS,CACP0F,aAAAA,GACE,MAAMrF,EAAM,iEACNyD,EAAS,CACbiC,KAAMzF,KAAKgF,aAEbhF,KAAKC,MAAMyF,KAAK3F,EAAK,CAAEX,KAAMoE,IAC1BrD,MAAMwF,IACL3F,KAAK4F,kBAAkBD,EAAK,SAC5BtF,QAAQC,IAAIqF,GACZ3F,KAAKL,SAAS,GAEpB,EACAmE,UAAAA,CAAYpD,GACV,MAAMX,EAAM,gEAAkEW,EAAKmC,KACnF7C,KAAKV,WAAY,EACjBU,KAAKR,OAAOC,YAAciB,EAAKmC,GAC/B,MAAMxD,EAAO,CACXwG,WAAYnF,EAAKmF,WACjBlF,IAAKD,EAAKC,KAEZX,KAAKC,MAAM6F,IAAI/F,EAAK,CAAEX,KAAMC,IACzBc,MAAMC,IACLC,QAAQC,IAAIF,GACZJ,KAAKR,OAAOC,YAAc,GACnBO,KAAKL,aAEbQ,MAAMC,IACLJ,KAAK+F,MAAM,eAAgB/F,KAAKX,MAChCgB,QAAQC,IAAI,eAAgBN,KAAKT,cAAc,GAErD,EACA2D,cAAAA,CAAgBL,GACdxC,QAAQC,IAAI,QACZN,KAAKR,OAAOC,YAAcoD,EAC1B,MAAM9C,EAAM,gEAAkE8C,IAC9E7C,KAAKC,MAAM+F,OAAOjG,GACfI,MAAMwF,IACL3F,KAAKR,OAAOC,YAAc,GAC1BY,QAAQC,IAAIqF,GACL3F,KAAKL,aAEbQ,MAAMwF,IACL3F,KAAK+F,MAAM,eAAgB/F,KAAKX,MAChCgB,QAAQC,IAAI,mBAAoBN,KAAKT,cAAc,GAEzD,GAEF0G,OAAQ,CAACC,EAAAA,I,UC5IX,MAAMC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,KAEpE,O","sources":["webpack://final-project/./src/mixins/cartMixin.js","webpack://final-project/./src/views/UserCart.vue","webpack://final-project/./src/views/UserCart.vue?698a"],"sourcesContent":["export default {\r\n  data () {\r\n    return {\r\n      cart: {},\r\n      isLoading: false,\r\n      cartItemCount: 0, // 用於存儲購物車商品數量\r\n      status: {\r\n        loadingItem: ''\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    getCart () {\r\n      return new Promise((resolve, reject) => {\r\n        const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/cart`\r\n        this.isLoading = true\r\n        this.$http.get(url)\r\n          .then((response) => {\r\n            console.log(response)\r\n            this.cart = response.data.data\r\n            this.cartItemCount = this.cart.carts.reduce((total, item) => total + item.qty, 0)\r\n            this.isLoading = false\r\n            resolve(response) // 確保 Promise 被 resolved\r\n          })\r\n          .catch((error) => {\r\n            this.isLoading = false\r\n            reject(error) // 確保 Promise 被 rejected\r\n          })\r\n      })\r\n    }\r\n  },\r\n  created () {\r\n    this.getCart()\r\n  }\r\n}\r\n","<template>\r\n  <Loading :active=\"isLoading\"></Loading>\r\n  <!-- 購物車列表 -->\r\n  <div class=\"col-md-7 mx-auto\">\r\n    <div class=\"top\">\r\n      <ul>\r\n        <li><router-link to=\"/\" class=\"cart-router\">首頁</router-link></li>\r\n        <li>/</li>\r\n        <li>購物車</li>\r\n      </ul>\r\n    </div>\r\n    <hr>\r\n    <p>購物清單</p>\r\n    <hr>\r\n    <!-- 購物車列表 -->\r\n    <div class=\"sticky-top\">\r\n      <table class=\"table align-middle\">\r\n        <thead>\r\n          <tr>\r\n            <th></th>\r\n            <th>品名</th>\r\n            <th style=\"width: 110px\">數量</th>\r\n            <th>單價</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <template v-if=\"cart.carts\">\r\n            <tr v-for=\"item in cart.carts\" :key=\"item.id\">\r\n              <td>\r\n                <button type=\"button\" class=\"btn btn-outline-danger btn-sm\"\r\n                        :disabled=\"status.loadingItem === item.id\"\r\n                        @click=\"removeCartItem(item.id)\">\r\n                  <i class=\"bi bi-x\"></i>\r\n                </button>\r\n              </td>\r\n              <td>\r\n                {{ item.product.title }}\r\n                <div class=\"text-success\" v-if=\"item.coupon\">\r\n                  已套用優惠券\r\n                </div>\r\n              </td>\r\n              <td>\r\n                <div class=\"input-group input-group-sm\">\r\n                  <input type=\"number\" class=\"form-control\"\r\n                        min=\"1\"\r\n                        :disabled=\"item.id === status.loadingItem\"\r\n                        @change=\"updateCart(item)\"\r\n                        v-model.number=\"item.qty\">\r\n                  <div class=\"input-group-text\">/ {{ item.product.unit }}</div>\r\n                </div>\r\n              </td>\r\n              <td class=\"text-end\">\r\n                <small v-if=\"cart.final_total !== cart.total\" class=\"text-success\">折扣價：</small>\r\n                {{ $filters.currency(item.final_total) }}\r\n              </td>\r\n            </tr>\r\n          </template>\r\n        </tbody>\r\n        <tfoot>\r\n          <tr>\r\n            <td colspan=\"3\" class=\"text-end\">總計</td>\r\n            <td class=\"text-end\">{{ $filters.currency(cart.total) }}</td>\r\n          </tr>\r\n          <tr v-if=\"cart.final_total !== cart.total\">\r\n            <td colspan=\"3\" class=\"text-end text-success\">折扣價</td>\r\n            <td class=\"text-end text-success\">{{ $filters.currency(cart.final_total) }}</td>\r\n          </tr>\r\n        </tfoot>\r\n      </table>\r\n      <div class=\"input-group mb-3 input-group-sm\">\r\n        <input type=\"text\" class=\"form-control\" v-model=\"coupon_code\" placeholder=\"請輸入優惠碼\">\r\n        <div class=\"input-group-append\">\r\n          <button class=\"btn btn-outline-secondary\" type=\"button\" @click=\"addCouponCode\">\r\n            套用優惠碼\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"text-center mt-3\">\r\n      <button class=\"btn btn-outline-secondary mx-2\" type=\"button\">\r\n        <router-link class=\"navbar-brand\" to=\"/user/list\">繼續購物</router-link>\r\n      </button>\r\n      <button class=\"btn btn-outline-secondary mx-2\" type=\"button\">\r\n        <router-link class=\"navbar-brand\" to=\"/user/checkinfo\">前往結帳</router-link>\r\n      </button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport cartMixin from '@/mixins/cartMixin'\r\n\r\nexport default {\r\n  emits: ['cart-updated'], // 在此處聲明自定義事件\r\n  data () {\r\n    return {\r\n      coupon_code: ''\r\n    }\r\n  },\r\n  methods: {\r\n    addCouponCode () {\r\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/coupon`\r\n      const coupon = {\r\n        code: this.coupon_code\r\n      }\r\n      this.$http.post(url, { data: coupon })\r\n        .then((res) => {\r\n          this.$httpMessageState(res, '加入優惠券')\r\n          console.log(res)\r\n          this.getCart()\r\n        })\r\n    },\r\n    updateCart (item) {\r\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/cart/${item.id}`\r\n      this.isLoading = true\r\n      this.status.loadingItem = item.id\r\n      const cart = {\r\n        product_id: item.product_id,\r\n        qty: item.qty\r\n      }\r\n      this.$http.put(url, { data: cart })\r\n        .then((response) => {\r\n          console.log(response)\r\n          this.status.loadingItem = ''\r\n          return this.getCart() // 確保返回的 Promise 是 this.getCart() 的\r\n        })\r\n        .then((response) => {\r\n          this.$emit('cart-updated', this.cart) // 發射事件通知父組件\r\n          console.log('觸發updateCart', this.cartItemCount)\r\n        })\r\n    },\r\n    removeCartItem (id) {\r\n      console.log('移除此項')\r\n      this.status.loadingItem = id\r\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/cart/${id}`\r\n      this.$http.delete(url)\r\n        .then((res) => {\r\n          this.status.loadingItem = ''\r\n          console.log(res)\r\n          return this.getCart() // 確保返回的 Promise 是 this.getCart() 的\r\n        })\r\n        .then((res) => {\r\n          this.$emit('cart-updated', this.cart) // 發射事件通知父組件\r\n          console.log('觸發removeCartItem', this.cartItemCount)\r\n        })\r\n    }\r\n  },\r\n  mixins: [cartMixin]\r\n}\r\n</script>\r\n\r\n<style>\r\n.top ul{\r\n  display: flex;\r\n  justify-content: flex-end\r\n}\r\n.top ul li {\r\n  list-style-type: none;\r\n  margin-right: 7px;\r\n}\r\n.cart-router {\r\n  text-decoration: none;\r\n  color: inherit;\r\n}\r\n</style>\r\n","import { render } from \"./UserCart.vue?vue&type=template&id=23e68b38\"\nimport script from \"./UserCart.vue?vue&type=script&lang=js\"\nexport * from \"./UserCart.vue?vue&type=script&lang=js\"\n\nimport \"./UserCart.vue?vue&type=style&index=0&id=23e68b38&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["data","cart","isLoading","cartItemCount","status","loadingItem","methods","getCart","Promise","resolve","reject","url","this","$http","get","then","response","console","log","carts","reduce","total","item","qty","catch","error","created","class","_createElementVNode","style","_hoisted_12","key","colspan","type","_createElementBlock","_Fragment","_createVNode","_component_Loading","active","_ctx","_hoisted_1","_hoisted_2","_component_router_link","to","default","_withCtx","_createTextVNode","_","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_renderList","id","disabled","onClick","$event","$options","removeCartItem","_hoisted_13","_hoisted_11","_toDisplayString","product","title","coupon","_hoisted_14","_createCommentVNode","_hoisted_15","min","onChange","updateCart","_hoisted_16","number","_hoisted_17","unit","_hoisted_18","final_total","_hoisted_19","$filters","currency","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_cache","$data","coupon_code","placeholder","_hoisted_26","args","addCouponCode","_hoisted_27","_hoisted_28","_hoisted_29","emits","code","post","res","$httpMessageState","product_id","put","$emit","delete","mixins","cartMixin","__exports__","render"],"sourceRoot":""}